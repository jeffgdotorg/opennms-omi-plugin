SYNTAX_VERSION 5


SNMP "NNMi: NetIQ7.x Traps"
        DESCRIPTION "NetIQ AppManager 7.x Traps"
        SEVERITY Unknown
        APPLICATION "<$10>"
        MSGGRP "NetIQ"
        FORWARDUNMATCHED
        UNMATCHEDLOGONLY
        HELPTEXT "NOTIFICATION: Alert_Server@example.com"
        HELP "8f9d1cec-2e8a-71e2-1b0a-0a708dcd0000"
        SUPP_UNM_CONDITIONS
                DESCRIPTION "Suppress Unmatched .1.3.6.1.4.1.1691"
                CONDITION_ID "512a75c8-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691"
        MSGCONDITIONS
                DESCRIPTION "NetIQ7_Minor_pbxmaintserver_System_Name"
                CONDITION_ID "513279b2-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                        $7 "System Name:<@.source>"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<source>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NetIQ7_Minor_pbxmaintserver_System_Name

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: No action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "236e8e2c-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQ7_Minor_pbxmaintserver"
                CONDITION_ID "5139e0ee-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NetIQ7_Minor_pbxmaintserver

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: No action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "236ffafa-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQ7_Major_NortelCS_Call_Capacity_pbxmaintserver"
                CONDITION_ID "513de694-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                        $8 "Call Capacity"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQ7_Major_NortelCS_Call_Capacity_pbxmaintserver

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to access the Host Resource MIB to 
retrieve the calculated call capacity utilization (CCU) on a Call
Server. This script raises an event if CCU exceeds the threshold
you set. In addition, this script generates a data stream for CCU.
Rated call capacity (RCC) is a function of idle time and the number of call
attempts in an hour for a Call Server. It represents the maximum
level at which a Call Server's CPU can operate and still maintain
a high grade of service. RCC assumes the highest call traffic peak
during a busy hour is 30% higher than the average traffic level.
CCU is an indicator of the call traffic load on the Call Server
and is calculated as follows:
     The CallCapacity script retrieves the result of this
     calculation from the Host Resource MIB.

Important: The CCU value is not available from the Call Server
until 24 hours after a system restart. During that 24-hour window,
only negative values are returned until the correct value is
available. Therefore, the data stream for the CallCapacity script
will be \"0\" until the correct CCU value has been calculated.

RECOMMENDED ACTION: Action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "237160ac-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQ7_Major_pbxmaintserver_System_Name"
                CONDITION_ID "513f6028-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                        $7 "System Name:<@.source>"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<source>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQ7_Major_pbxmaintserver_System_Name

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: Action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2372ed32-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQ7_Major_pbxmaintserver"
                CONDITION_ID "514096be-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQ7_Major_pbxmaintserver

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: Action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "237453a2-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQ7_Critical_pbxmaintserver_System_Name"
                CONDITION_ID "514cabb6-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                        $7 "System Name:<@.source>"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<source>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQ7_Critical_pbxmaintserver_System_Name

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: Action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2375b44a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQ7_Critical_pbxmaintserver"
                CONDITION_ID "514df624-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQ7_Critical_pbxmaintserver

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: Action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23772654-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQ7_Generic_pbxmaintserver"
                CONDITION_ID "514fa2bc-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691"
                        NODE IP 0.0.0.0  "pbxmaintserver.example.com"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "NetIQ"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NetIQ7_Generic_pbxmaintserver

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: No action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23788d14-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQWarning_Cisco"
                CONDITION_ID "51508114-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 4
                        $5 "Cisco"
                SET
                        SERVERLOGONLY
                        SEVERITY Warning
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "PBXDiag"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NetIQWarning_Cisco

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: NetIQ AppManager Warning message.

RECOMMENDED ACTION: No action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "237a4f96-433b-71e3-0a00-0a708dcc0000"
        SUPPRESSCONDITIONS
                DESCRIPTION "NetIQWarning_NT_Discovery"
                CONDITION_ID "51513708-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 4
                        $7 "NT Discovery OK"
                DESCRIPTION "NetIQWarning_General_AsciiLog_No_Error"
                CONDITION_ID "be30d4d8-4300-71e2-1e78-0a708dcd0000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 4
                        $7 "contains no matches for error"
                        $9 "General_AsciiLog"
        MSGCONDITIONS
                DESCRIPTION "NetIQNormal_Cisco"
                CONDITION_ID "5151876c-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 5
                        $5 "Cisco"
                SET
                        SERVERLOGONLY
                        SEVERITY Normal
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "PBXDiag"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NetIQNormal_Cisco

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: NetIQ AppManager Normal message.

RECOMMENDED ACTION: No action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "237bb61a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQCritical_Capacity_Planning"
                CONDITION_ID "5153de18-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        $8 "<[TeamQuest|Measureware].service>"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "Performance"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQCritical_Capacity_Planning

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Capacity Planning services down.

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "237d1a0a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMajor_Capacity_Planning"
                CONDITION_ID "51549178-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        $8 "<[TeamQuest|Measureware].service>"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "Performance"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMajor_Capacity_Planning

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Capacity Planning Services down.

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "237e799a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_Capacity_Planning"
                CONDITION_ID "51558b0a-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $8 "<[TeamQuest|Measureware].service>"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_Capacity_Planning

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Capacity Planning services down.

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "237fdc86-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQWarning_Capacity_Planning"
                CONDITION_ID "51564072-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 4
                        $8 "<[TeamQuest|Measureware].service>"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQWarning_Capacity_Planning

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Capacity Planning services down.

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23813798-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_PKI"
                CONDITION_ID "5156f058-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $4 "ENT-501"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_PKI

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: NetIQ AppManager Minor message.

RECOMMENDED ACTION: Currently, no action by WSSS is required.  PKI Team will respond.

NOTIFICATION: PKITeam@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "238295c0-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_Cisco"
                CONDITION_ID "51581b2c-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $5 "Cisco"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "PBX"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_Cisco

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: No action required.

NOTIFICATION: VSGSupport@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2383f37a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_General_AsciiLog_PKI"
                CONDITION_ID "be30d514-4300-71e2-1e78-0a708dcd0000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $4 "PKI"
                        $9 "General_AsciiLog"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_General_AsciiLog

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor one or more ASCII text files
for specific strings and messages logged since the last monitoring
interval. Using this Knowledge Script you can specify a pattern or
search string to look for in specified ASCII files and report the
matching entries found in the monitoring period. The script checks
for changes to the text files that match the string you enter; it does
not re-scan the entire file at each interval.
In the first interval, the script reads the file and inserts a marker at
the end of the file. Note that the script does not search for a specified
search string during the first interval. In subsequent intervals, the
script checks the file for changes that match the search string you
specified. The script raises an event if the number of lines matching
your search criteria exceeds the threshold you set.

RECOMMENDED ACTION: Investigate the log message.

NOTIFICATION: NOTE_ONLY,PKITeam@example.com

COMMENTS: CR#500324

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "68686f78-3cd5-71e3-019b-0a708dcc0000"
                DESCRIPTION "NetIQMinor_ProcessDown_eTrust_SSO_Server"
                CONDITION_ID "5159aa50-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $7 "eTrust SSO Server"
                        $9 "ProcessDown"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_ProcessDown_eTrust_SSO_Server

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to determine whether specified 
processes are currently running. This script raises an event if a 
specified process is not running.

RECOMMENDED ACTION: Investigate process status, determine cause of failure,
restart process or develop a workaround until the problem can be fixed.

NOTIFICATION: David.Page@example.com,Sandeep.Talwar@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23856142-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_ProcessDown"
                CONDITION_ID "515ab1b6-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $9 "ProcessDown"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_ProcessDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to determine whether specified 
processes are currently running. This script raises an event if a 
specified process is not running.

RECOMMENDED ACTION: Investigate process status, determine cause of failure,
restart process or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2386c320-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_PortHealth"
                CONDITION_ID "515da0f6-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $9 "PortHealth"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_PortHealth

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to check whether system ports are
working properly. This script raises an event if a port is not operating.

RECOMMENDED ACTION: Investigate port outage, check the status of the
service which serves this port, determine the cause of the outage,
restart the service or develop a workaround until the problem can be
fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23882044-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_MSCS_GroupOwnerChange"
                CONDITION_ID "515e6ea0-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $9 "MSCS_GroupOwnerChange"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_MSCS_GroupOwnerChange

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to detect whether the owner of a 
cluster group has changed. Changes in the ownership of a cluster group
typically indicate a failover or failback operation has taken place. If
the owner of the cluster group changes, an event is raised.
Both the event and data detail message indicate the previous cluster
group owner and the new group owner.
Note This Knowledge Script can see shared resources from either the
active or the passive node because it uses the Cluster Administrator
API, instead of Perfmon counters. Similar Knowledge Scripts in other
modules can only see resources when their node is active. Use
AMAdmin_SetResDependency to avoid duplicate events, if you have
this Knowledge Script running on more than one node in a cluster.

RECOMMENDED ACTION: Investigate to see if the cluster failed-over to
the backup node, check to make sure all services are properly running,
determine the cause of the fail-over, determine is the cluster needs
to be scheduled to fail back over to the primary node.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2389857e-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_PagingHigh"
                CONDITION_ID "515f708e-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $9 "PagingHigh"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_PagingHigh

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor reads/writes per second 
to the pagefile. This script raises an event if the number of reads/writes
per second crosses the threshold you specify.

RECOMMENDED ACTION: Investigate the paging issue, determine if there is a
memory leak in a running service, if so, restart the service. If there
is a consistent paging problem the server may require additional memory,
a larger pagefile, or an application patch.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "686edf8e-3cd5-71e3-019b-0a708dcc0000"
                DESCRIPTION "NetIQMinor_MemByProcess"
                CONDITION_ID "5160a4a4-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $9 "MemByProcess"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_MemByProcess

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor process memory usage. 
This script monitors individual memory use for each specified process,
and the total memory use for all specified processes. If a process is
not found, the script assumes that the process is not currently
running, and reports 0 as the memory result.
You can use this script to monitor multiple processes with the same
name. For example, the process spawned by each instance of
svchost.exe running on the same computer. See the help for the
Processes (comma separated, without spaces) parameter for more
information.
Notes: This script does not detect invalid process names. If you type
an invalid process name, the script assumes that the process is not
running, and reports 0 as the result.
If the memory usage for the named processes exceeds the threshold
limit, an event is raised. However, this is not applicable for Windows
System Idle Process. The System Idle Process indicates the percentage of
idle CPU resources. If no applications are running, this process
indicates a high idle capacity. The high percentage causes a threshold
breach raising an event that the System Idle Process consumes high
memory. This event message may be safely ignored because the high
percentage refers to the high idle capacity and not high memory usage.

RECOMMENDED ACTION: Check the status of the process, restart if necessary.
IF this is a recurring problem, an application patch may be required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "238af620-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_ServiceDown_service_does_not_exist"
                CONDITION_ID "516203b2-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $7 "service does not exist"
                        $9 "ServiceDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NetIQMinor_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "238c5bbe-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_ServiceDown_Service_Started"
                CONDITION_ID "81c3f264-7cea-71e1-09e4-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $7 "service was started"
                        $9 "ServiceDown"
                SET
                        SEVERITY Normal
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "238dbfae-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_ServiceDown"
                CONDITION_ID "5162efca-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $9 "EXAMPLE_ServiceDown"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "238f2876-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_FileChanged_W-ERA-002"
                CONDITION_ID "5163cf94-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $4 "W-ERA-002"
                        $9 "FileChanged"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_FileChanged_W-ERA-002

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to check whether a specified file 
has changed since the last monitoring interval. This script compares the
current size, timestamp, and attributes for a file to the size,
timestamp, and attribute settings found for the file the last time the
script ran.
You can choose to raise an event if the size, timestamp, or attribute
indicates the file has been modified, or raise an event if any of these
properties indicate the file has not been changed since the last
monitoring interval.
Because this script checks the file properties rather than the file
content, you can use this script with virtually any file type.

RECOMMENDED ACTION: Check the circumstances of the file change event.

NOTIFICATION: Thomas.Pennington@example.com,Charles.Hopkins@example.com,NOTE_ONLY

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "239096f2-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_FileChanged"
                CONDITION_ID "5164d9c0-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $9 "FileChanged"
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor_FileChanged

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to check whether a specified file 
has changed since the last monitoring interval. This script compares the
current size, timestamp, and attributes for a file to the size,
timestamp, and attribute settings found for the file the last time the
script ran.
You can choose to raise an event if the size, timestamp, or attribute
indicates the file has been modified, or raise an event if any of these
properties indicate the file has not been changed since the last
monitoring interval.
Because this script checks the file properties rather than the file
content, you can use this script with virtually any file type.

RECOMMENDED ACTION: Check the circumstances of the file change event.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2391f8b2-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMajor_ServiceDown_Service_Started"
                CONDITION_ID "a9728abe-7cea-71e1-09e4-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        $7 "service was started"
                        $9 "ServiceDown"
                SET
                        SEVERITY Normal
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMajor_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23935b08-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMajor_ServiceDown"
                CONDITION_ID "51660c46-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        $9 "ServiceDown"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMajor_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2394bc78-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMajor_MemByProcess"
                CONDITION_ID "5167045c-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        $9 "MemByProcess"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMajor_MemByProcess

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor process memory usage. 
This script monitors individual memory use for each specified process,
and the total memory use for all specified processes. If a process is
not found, the script assumes that the process is not currently
running, and reports 0 as the memory result.
You can use this script to monitor multiple processes with the same
name. For example, the process spawned by each instance of
svchost.exe running on the same computer. See the help for the
Processes (comma separated, without spaces) parameter for more
information.
Notes: This script does not detect invalid process names. If you type
an invalid process name, the script assumes that the process is not
running, and reports 0 as the result.
If the memory usage for the named processes exceeds the threshold
limit, an event is raised. However, this is not applicable for Windows
System Idle Process. The System Idle Process indicates the percentage of
idle CPU resources. If no applications are running, this process
indicates a high idle capacity. The high percentage causes a threshold
breach raising an event that the System Idle Process consumes high
memory. This event message may be safely ignored because the high
percentage refers to the high idle capacity and not high memory usage.

RECOMMENDED ACTION: Check the status of the process, restart if necessary.
IF this is a recurring problem, an application patch may be required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23961898-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQCritical_MSCS_ResourceOwnerChange"
                CONDITION_ID "5167fc22-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        $9 "MSCS_ResourceOwnerChange"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQCritical_MSCS_ResourceOwnerChange

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to detect whether the owner of a 
cluster resource has changed. Changes in the ownership of a resource
typically indicate a failover or failback operation has taken place. If
the owner of the cluster resource changes, an event is raised.
Both the event and data detail message indicate the previous cluster
resource owner and the new resource owner.
Note: This Knowledge Script can see shared resources from either the
active or the passive node because it uses the Cluster Administrator
API, instead of Perfmon counters. Similar Knowledge Scripts in other
modules can only see resources when their node is active. Use
AMAdmin_SetResDependency to avoid duplicate events, if you have
this Knowledge Script running on more than one node in a cluster.

RECOMMENDED ACTION: Investigate to see if the cluster failed-over to
the backup node, check to make sure all services are properly running,
determine the cause of the fail-over, determine is the cluster needs
to be scheduled to fail back over to the primary node.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2397765c-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQCritical_EventLog"
                CONDITION_ID "5168eb0a-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        $9 "EventLog"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 0.0.0.0  "ems.uspto.go" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQCritical_EventLog

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: An event of note has been written to the Windows system
EventLog.

RECOMMENDED ACTION: Investigate the event and take the appropriate action.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "2398d6d2-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQCritical_LogicalDiskSpace"
                CONDITION_ID "5169eab4-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        $9 "LogicalDiskSpace"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQCritical_LogicalDiskSpace

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the logical disk space 
usage. This script checks the percentage of disk space used and the free
space in megabytes. This script raises an event if either the percentage
of used space or the free space (MB) crosses the threshold you specify.

RECOMMENDED ACTION: Ivestigate the disk usage of the specified device,
cleanup unneeded files or increase disk space.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "239a34b4-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQCritical_MSCS_GroupOwnerChange"
                CONDITION_ID "516aabe8-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        $9 "MSCS_GroupOwnerChange"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQCritical_MSCS_GroupOwnerChange

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to detect whether the owner of a cluster
group has changed. Changes in the ownership of a cluster group
typically indicate a failover or failback operation has taken place. If
the owner of the cluster group changes, an event is raised.
Both the event and data detail message indicate the previous cluster
group owner and the new group owner.
Note This Knowledge Script can see shared resources from either the
active or the passive node because it uses the Cluster Administrator
API, instead of Perfmon counters. Similar Knowledge Scripts in other
modules can only see resources when their node is active. Use
AMAdmin_SetResDependency to avoid duplicate events, if you have
this Knowledge Script running on more than one node in a cluster.

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "239b93f4-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQCritical_EXAMPLE_ServiceDown"
                CONDITION_ID "516b8a5e-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                        $9 "EXAMPLE_ServiceDown"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQCritical_EXAMPLE_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "239cf352-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMajor_XMPL_DiskSpace"
                CONDITION_ID "64d48144-8273-71e1-0f75-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                        $9 "XMPL_DiskSpace"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMajor_XMPL_DiskSpace

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the logical disk space 
usage. This script checks the percentage of disk space used and the free
space in megabytes. This script raises an event if either the percentage
of used space or the free space (MB) crosses the threshold you specify.

RECOMMENDED ACTION: Ivestigate the disk usage of the specified device,
cleanup unneeded files or increase disk space.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "239e54c2-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMajor"
                CONDITION_ID "516cb12c-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 2
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMajor

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Major SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "239fb51a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQCritical"
                CONDITION_ID "516d436c-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 1
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQCritical

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Critical SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23a11068-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "Exchange2007_Normal"
                CONDITION_ID "00a0bcda-69bf-71e3-1970-0a708dcc0000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $7 "<*>mail volume<*>exceeds threshold"
                        $9 "^Exchange2007"
                SET
                        SERVERLOGONLY
                        SEVERITY Normal
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7>"
                        HELPTEXT "EVENT NAME: Exchange2007

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the health of Exchange 
2007 server roles. This script monitors the following services and activities:
- The Windows Event Log for errors and warnings whose source is
  *exchange* (any service whose name contains the word \"exchange\")
- Running status of all Exchange 2007 services
- Clock synchronization
- Response time to ActiveSync, Outlook Web Access, Outlook Web services,
  and the Autodiscovery service
- Number of messages in queue and change in queue size
- Status of send, receive, and foreign connectors
- Speed of mail flow to a specified email address or Mailbox Server
- Availability of offline address books and public folders
- Mailbox accessibility
- Communication between Hub Transport Server and Mailbox Server
- Synchronization between Hub Transport Server and Edge Transport Server
- Response to SMTP requests
- Replication health
- Database status
- Available disk space

RECOMMENDED ACTION: No Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "00a0bd0c-69bf-71e3-1970-0a708dcc0000"
                DESCRIPTION "Exchange2007"
                CONDITION_ID "516dd6b0-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "^Exchange2007"
                SET
                        SEVERITY Critical
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <89>"
                        OPACTION "escalate <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: Exchange2007

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the health of Exchange 
2007 server roles. This script monitors the following services and activities:
- The Windows Event Log for errors and warnings whose source is
  *exchange* (any service whose name contains the word \"exchange\")
- Running status of all Exchange 2007 services
- Clock synchronization
- Response time to ActiveSync, Outlook Web Access, Outlook Web services,
  and the Autodiscovery service
- Number of messages in queue and change in queue size
- Status of send, receive, and foreign connectors
- Speed of mail flow to a specified email address or Mailbox Server
- Availability of offline address books and public folders
- Mailbox accessibility
- Communication between Hub Transport Server and Mailbox Server
- Synchronization between Hub Transport Server and Edge Transport Server
- Response to SMTP requests
- Replication health
- Database status
- Available disk space

RECOMMENDED ACTION: Action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23a26c6a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_CpuLoaded"
                CONDITION_ID "516edff6-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_CpuLoaded"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: 

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: This Knowledge Script monitors total CPU usage and queue length
to determine whether the CPU is overloaded, and raises an event if
the CPU is overloaded when both the total CPU usage and CPU
queue length thresholds are exceeded.

RECOMMENDED ACTION: Investigate CPU spike, determine cause of spike,
restart service/process or develop a workaround until the problem can be 
fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23a3d4c4-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_DiskSpace"
                CONDITION_ID "516fbf2a-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_DiskSpace"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NT_DiskSpace

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the logical disk space 
usage. This script checks the percentage of disk space used and the free
space in megabytes. This script raises an event if either the percentage
of used space or the free space (MB) crosses the threshold you specify.

RECOMMENDED ACTION: Ivestigate the disk usage of the specified device,
cleanup unneeded files or increase disk space.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23a53378-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_FileChanged"
                CONDITION_ID "51720032-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_FileChanged"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NT_FileChanged

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to check whether a specified file has
changed since the last monitoring interval. This script compares the
current size, timestamp, and attributes for a file to the size,
timestamp, and attribute settings found for the file the last time the
script ran.

RECOMMENDED ACTION: Investigate the change, determine cause of 
change.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23a69150-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_MemByProcess"
                CONDITION_ID "5172c864-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_MemByProcess"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NT_MemByProcess

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor process memory usage. 
This script monitors individual memory use for each specified process,
and the total memory use for all specified processes. If a process is
not found, the script assumes that the process is not currently
running, and reports 0 as the memory result.
You can use this script to monitor multiple processes with the same
name. For example, the process spawned by each instance of
svchost.exe running on the same computer. See the help for the
Processes (comma separated, without spaces) parameter for more
information.
Notes: This script does not detect invalid process names. If you type
an invalid process name, the script assumes that the process is not
running, and reports 0 as the result.
If the memory usage for the named processes exceeds the threshold
limit, an event is raised. However, this is not applicable for Windows
System Idle Process. The System Idle Process indicates the percentage of
idle CPU resources. If no applications are running, this process
indicates a high idle capacity. The high percentage causes a threshold
breach raising an event that the System Idle Process consumes high
memory. This event message may be safely ignored because the high
percentage refers to the high idle capacity and not high memory usage.

RECOMMENDED ACTION: Check the status of the process, restart if necessary.
IF this is a recurring problem, an application patch may be required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23a7ef78-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_MemUtil"
                CONDITION_ID "5175125e-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_MemUtil"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NT_MemUtil

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor physical memory, virtual
memory, and the paging files. This script raises an event if any usage
level crosses the threshold you specify.

RECOMMENDED ACTION: Check the status of the process, restart if necessary.
IF this is a recurring problem, an application patch may be required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23a94ee0-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_ProcessDown"
                CONDITION_ID "51760ace-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_ProcessDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NT_ProcessDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to determine whether specified 
processes are currently running. This script raises an event if a 
specified process is not running.

RECOMMENDED ACTION: Investigate process status, determine cause of failure,
restart process or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23aab10e-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_ServiceDown"
                CONDITION_ID "5176e098-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_ServiceDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NT_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23ac0f54-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NT_TopCpuProcs"
                CONDITION_ID "5177d76e-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "NT_TopCpuProcs"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NT_TopCpuProcs

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the total CPU resources used
by all processes and which processes consume the most CPU
resources. This script raises an event if the percentage of CPU use
exceeds the threshold you specify.

RECOMMENDED ACTION: Investigate high CPU utilixation, determine cause of 
spikes, restart service or develop a workaround until the problem can be 
fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23ad6f98-433b-71e3-0a00-0a708dcc0000"
        SUPPRESSCONDITIONS
                DESCRIPTION "XMPL_DiskSpace_Suppress"
                CONDITION_ID "7daca08c-9acb-71e1-1875-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $8 "Free Space (MB): <<#> -ge 1000>."
                        $9 "^XMPL_DiskSpace"
                DESCRIPTION "XMPL_DiskSpace_Per_disk"
                CONDITION_ID "f5cfac0c-a34b-71e1-049c-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $7 "Per-disk threshold values"
                        $9 "XMPL_DiskSpace"
        MSGCONDITIONS
                DESCRIPTION "XMPL_DiskSpace_1GB"
                CONDITION_ID "aff29326-9ac6-71e1-1875-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $8 "Free Space (MB): <<#> -lt 1000>."
                        $9 "^XMPL_DiskSpace"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: XMPL_DiskSpace

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the logical disk space 
usage. This script checks the percentage of disk space used and the free
space in megabytes. This script raises an event if either the percentage
of used space or the free space (MB) crosses the threshold you specify.

RECOMMENDED ACTION: Ivestigate the disk usage of the specified device,
cleanup unneeded files or increase disk space.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23aeceb0-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "XMPL_DiskSpace"
                CONDITION_ID "5178cb24-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "XMPL_DiskSpace"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: EXAMPLE_DiskSpace

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the logical disk space 
usage. This script checks the percentage of disk space used and the free
space in megabytes. This script raises an event if either the percentage
of used space or the free space (MB) crosses the threshold you specify.

RECOMMENDED ACTION: Ivestigate the disk usage of the specified device,
cleanup unneeded files or increase disk space.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b03066-433b-71e3-0a00-0a708dcc0000"
        SUPPRESSCONDITIONS
                DESCRIPTION "XMPL_EventLog1"
                CONDITION_ID "237923be-2e8d-71e2-1b0a-0a708dcd0000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691"
                        $4 "XMPL_EventLog"
                DESCRIPTION "XMPL_EventLog"
                CONDITION_ID "51799324-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "XMPL_EventLog"
        MSGCONDITIONS
                DESCRIPTION "EXAMPLE_LogicalDiskSpace"
                CONDITION_ID "51847e60-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "EXAMPLE_LogicalDiskSpace"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: EXAMPLE_LogicalDiskSpace

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the logical disk space 
usage. This script checks the percentage of disk space used and the free
space in megabytes. This script raises an event if either the percentage
of used space or the free space (MB) crosses the threshold you specify.

RECOMMENDED ACTION: Ivestigate the disk usage of the specified device,
cleanup unneeded files or increase disk space.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b1910e-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "EXAMPLE_NTServiceDown"
                CONDITION_ID "518bd3f4-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "EXAMPLE_NTServiceDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: EXAMPLE_NTServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b2fa9e-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "EXAMPLE_ProcessDown_LM2_ticrs-ais-01"
                CONDITION_ID "518cec62-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        NODE IP 0.0.0.0  "ticrs-ais-01.example.com"
                        $9 "EXAMPLE_ProcessDown LM2"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: EXAMPLE_ProcessDown_LM2_ticrs-ais-01

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to determine whether specified 
processes are currently running. This script raises an event if a 
specified process is not running.

RECOMMENDED ACTION: Investigate process status, determine cause of failure,
restart process or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b45b46-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "EXAMPLE_ProcessDown_LM2_w-tmsrv-001"
                CONDITION_ID "518ed554-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        NODE IP 0.0.0.0  "w-tmsrv-001.example.com"
                        $9 "EXAMPLE_ProcessDown LM2"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ACTIONNODE IP 10.112.141.100  "ems.example.com" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: EXAMPLE_ProcessDown_LM2_w-tmsrv-001

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to determine whether specified 
processes are currently running. This script raises an event if a 
specified process is not running.

RECOMMENDED ACTION: Investigate process status, determine cause of failure,
restart process or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b5c0bc-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "EXAMPLE_ProcessDown"
                CONDITION_ID "5190ac44-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "EXAMPLE_ProcessDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: EXAMPLE_ProcessDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to determine whether specified 
processes are currently running. This script raises an event if a 
specified process is not running.

RECOMMENDED ACTION: Investigate process status, determine cause of failure,
restart process or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b728f8-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "XMPL_ServiceDown_Failed_to_enumerate_services"
                CONDITION_ID "bc99b3c2-a34d-71e1-049c-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $7 "Job Failure: Failed to enumerate services"
                        $9 "XMPL_ServiceDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: EXAMPLE_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b88b8a-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "XMPL_ServiceDown_Stop_Normal_2"
                CONDITION_ID "7805cbc4-cc4c-71e1-0045-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $7 "Windows Service: The Software Protection service was found to be stopped in a normal manner"
                        $9 "XMPL_ServiceDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: EXAMPLE_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23b9ed0e-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "XMPL_ServiceDown_Stop_Normal"
                CONDITION_ID "c537272e-cc1c-71e1-1154-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $7 "Windows Service: The Shell Hardware Detection service was found to be stopped in a normal manner"
                        $9 "XMPL_ServiceDown"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: EXAMPLE_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23bb5630-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "XMPL_ServiceDown_Service-started"
                CONDITION_ID "ec2ba9a6-d4da-71e1-1c05-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $7 "service was started"
                        $9 "XMPL_ServiceDown"
                SET
                        SEVERITY Normal
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: EXAMPLE_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23bcb7b4-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "XMPL_ServiceDown"
                CONDITION_ID "5191e118-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "XMPL_ServiceDown"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: EXAMPLE_ServiceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to monitor the up and down status 
of specified Windows Services. If any service is detected down, it can be
restarted. This script allows you to monitor Windows Services that
are not discovered by AppManager, for example, the WinLogon or
NetIQms services.
Tip: Use the General_ServiceDown script to monitor discovered
services that appear in the TreeView pane of the Operator Console.

RECOMMENDED ACTION: Investigate service status, determine cause of failure,
restart service or develop a workaround until the problem can be fixed.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23be1960-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "XMPL_GroupMembership"
                CONDITION_ID "83c4689c-a043-71e1-05aa-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "XMPL_GroupMembership"
                SET
                        SERVERLOGONLY
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: XMPL_GroupMembership

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: XMPL_GroupMembership

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23bf7d28-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "MSCS_ResourceDown"
                CONDITION_ID "eeb1ed10-a042-71e1-05aa-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "MSCS_ResourceDown"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: MSCS_ResourceDown

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Use this Knowledge Script to detect whether or not a cluster resource
is online. If the resource is not online, an event is raised. You can set
the Knowledge Script to attempt to bring the cluster resource online
automatically.
Note This Knowledge Script can see shared resources from either the
active or the passive node because it used the Cluster Administrator
API, instead of Perfmon counters. Similar Knowledge Scripts in other
modules can only see resources when their node is active. Use
AMAdmin_SetResDependency to avoid duplicate events, if you have
this Knowledge Script running on more than one node in a cluster.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23c0e424-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "OCS_SystemUsage"
                CONDITION_ID "260ff230-a042-71e1-05aa-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $9 "OCS_SystemUsage"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: OCS_SystemUsage

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: OCS_SysteUsage

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23c2453a-433b-71e3-0a00-0a708dcc0000"
        SUPPRESSCONDITIONS
                DESCRIPTION "NetIQNormal"
                CONDITION_ID "51935d90-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 5
        MSGCONDITIONS
                DESCRIPTION "NetIQWarning"
                CONDITION_ID "5193936e-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 4
                SET
                        SERVERLOGONLY
                        SEVERITY Warning
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        HELPTEXT "EVENT NAME: NetIQWarning

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Warning SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: No action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "23c3a150-433b-71e3-0a00-0a708dcc0000"
                DESCRIPTION "NetIQMinor_Failed_to_read"
                CONDITION_ID "5195f51e-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                        $7 "Failed to read service status of https-uspto-a-hps-"
                SET
                        SEVERITY Major
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: No action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "68abb99a-3cd5-71e3-019b-0a708dcc0000"
                DESCRIPTION "NetIQMinor"
                CONDITION_ID "227721f8-7552-71e2-0596-0a708dcc0000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691.2"
                        $G 6
                        $S 3
                SET
                        SEVERITY Minor
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                        AUTOACTION "true" ACK
                        OPACTION "escalate_message <$MSG_ID>" ANNOTATE
                        NOTIFICATION
                        HELPTEXT "EVENT NAME: NetIQMinor

EVENT TYPE: NetIQ AppManager SNMP trap

DESCRIPTION: Minor SNMP trap generated by NetIQ applications and services.

RECOMMENDED ACTION: No action required.

NOTIFICATION: Alert_Server@example.com

COMMENTS: 

WEB LINKS: https://ems-web.example.com/ems_app/index.jsp
https://www.netiq.com/support/default.asp?tab=ProductSupport&product=am

GATHER SCRIPTS:"
                        HELP "68ad028c-3cd5-71e3-019b-0a708dcc0000"
                DESCRIPTION "netIQGenericTrap"
                CONDITION_ID "8812b118-a37e-71e1-049c-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691"
                        $1 "Windows Event"
                SET
                        SERVERLOGONLY
                        SEVERITY Warning
                        NODE IP 0.0.0.0  "<$22>"
                        APPLICATION "<$6>"
                        MSGGRP "NetIQ"
                        TEXT "<$21>"
                DESCRIPTION "netIQExtendedTrap"
                CONDITION_ID "9bef8c6a-a37e-71e1-049c-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691"
                        $G 6
                        $S 2
                SET
                        SERVERLOGONLY
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
                DESCRIPTION "NetIQ_Generic_Event_error_accessing_eventlog"
                CONDITION_ID "5197cdb2-7368-71e1-0cd3-0a708d640000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691"
                        $G 6
                        $S 2
                SET
                        SERVERLOGONLY
                        SEVERITY Warning
                        NODE IP 0.0.0.0  "<$22>"
                        APPLICATION "<$10>"
                        MSGGRP "NetIQ"
                        TEXT "<$1>"
                DESCRIPTION "NetIQ_Generic_Event"
                CONDITION_ID "e32c4b36-488c-71e3-0a00-0a708dcc0000"
                CONDITION
                        $e ".1.3.6.1.4.1.1691"
                SET
                        SERVERLOGONLY
                        NODE IP 0.0.0.0  "<$4>"
                        APPLICATION "<$9>"
                        MSGGRP "NetIQ"
                        TEXT "<$5>: <$7> - <$8>"
